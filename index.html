<!doctype html>
<head><meta charset="utf-8"><title>Cancelable Promises</title><script type="application/json" id="menu-search-biblio">[{"type":"clause","id":"","aoid":null,"title":"Introduction","number":"","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Introduction"},{"type":"clause","id":"sec-promise-objects","aoid":null,"title":"Promise Objects","number":"1","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Promise Objects"},{"type":"clause","id":"sec-promise-abstract-operations","aoid":null,"title":"Promise Abstract Operations","number":"1.1","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Promise Abstract Operations"},{"type":"clause","id":"sec-promisereaction-records","aoid":null,"title":"PromiseReaction Records","number":"1.1.1","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"PromiseReaction Records"},{"type":"clause","id":"sec-promise-resolve-functions","aoid":null,"title":"Promise Resolve Functions","number":"1.1.2","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Promise Resolve Functions"},{"type":"op","aoid":"ResolvePromise","refId":"sec-resolvepromise","location":"","key":"ResolvePromise"},{"type":"clause","id":"sec-resolvepromise","aoid":"ResolvePromise","title":"ResolvePromise ( _promise_, _resolution_ )","number":"1.1.3","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"ResolvePromise ( _promise_, _resolution_ )"},{"type":"op","aoid":"RejectPromise","refId":"sec-rejectpromise","location":"","key":"RejectPromise"},{"type":"clause","id":"sec-rejectpromise","aoid":"RejectPromise","title":"RejectPromise ( _promise_, _reason_ )","number":"1.1.4","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"RejectPromise ( _promise_, _reason_ )"},{"type":"op","aoid":"HostPromiseRejectionTracker","refId":"sec-host-promise-rejection-tracker","location":"","key":"HostPromiseRejectionTracker"},{"type":"clause","id":"sec-host-promise-rejection-tracker","aoid":"HostPromiseRejectionTracker","title":"HostPromiseRejectionTracker ( _promise_, _operation_ )","number":"1.1.5","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"HostPromiseRejectionTracker ( _promise_, _operation_ )"},{"type":"clause","id":"sec-promise-jobs","aoid":null,"title":"Promise Jobs","number":"1.2","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Promise Jobs"},{"type":"op","aoid":"PromiseReactionJob","refId":"sec-promisereactionjob","location":"","key":"PromiseReactionJob"},{"type":"clause","id":"sec-promisereactionjob","aoid":"PromiseReactionJob","title":"PromiseReactionJob ( _reaction_, _argument_ )","number":"1.2.1","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"PromiseReactionJob ( _reaction_, _argument_ )"},{"type":"clause","id":"sec-properties-of-the-promise-prototype-object","aoid":null,"title":"Properties of the Promise Prototype Object","number":"1.3","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Properties of the Promise Prototype Object"},{"type":"clause","id":"sec-promise.prototype.else","aoid":null,"title":"Promise.prototype.else ( _onErrored_ )","number":"1.3.1","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Promise.prototype.else ( _onErrored_ )"},{"type":"clause","id":"sec-promise.prototype.then","aoid":null,"title":"Promise.prototype.then ( _onFulfilled_, _onRejected_ )","number":"1.4","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Promise.prototype.then ( _onFulfilled_, _onRejected_ )"},{"type":"op","aoid":"PerformPromiseThen","refId":"sec-performpromisethen","location":"","key":"PerformPromiseThen"},{"type":"clause","id":"sec-performpromisethen","aoid":"PerformPromiseThen","title":"PerformPromiseThen ( _promise_, _onFulfilled_, _onRejected_, _resultCapability_, _rejectReactionType_ )","number":"1.4.1","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"PerformPromiseThen ( _promise_, _onFulfilled_, _onRejected_, _resultCapability_, _rejectReactionType_ )"},{"type":"clause","id":"sec-cancel-objects","aoid":null,"title":"Cancel Objects","number":"2","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Cancel Objects"},{"type":"clause","id":"sec-cancel-constructor","aoid":null,"title":"The Cancel Constructor","number":"2.1","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"The Cancel Constructor"},{"type":"clause","id":"sec-cancel-message","aoid":null,"title":"Cancel ( _message_ )","number":"2.1.1","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Cancel ( _message_ )"},{"type":"clause","id":"sec-properties-of-the-cancel-constructor","aoid":null,"title":"Properties of the Cancel Constructor","number":"2.2","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Properties of the Cancel Constructor"},{"type":"clause","id":"sec-cancel.prototype","aoid":null,"title":"Cancel.prototype","number":"2.2.1","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Cancel.prototype"},{"type":"clause","id":"sec-properties-of-the-cancel-prototype-object","aoid":null,"title":"Properties of the Cancel Prototype Object","number":"2.3","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Properties of the Cancel Prototype Object"},{"type":"clause","id":"sec-cancel.prototype.constructor","aoid":null,"title":"Cancel.prototype.constructor","number":"2.3.1","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Cancel.prototype.constructor"},{"type":"clause","id":"sec-cancel.prototype.tostring","aoid":null,"title":"Cancel.prototype.toString ( )","number":"2.3.2","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Cancel.prototype.toString ( )"},{"type":"clause","id":"sec-properties-of-cancel-instances","aoid":null,"title":"Properties of Cancel Instances","number":"2.4","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Properties of Cancel Instances"},{"type":"clause","id":"sec-canceltoken-objects","aoid":null,"title":"CancelToken Objects","number":"3","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"CancelToken Objects"},{"type":"clause","id":"sec-canceltoken-constructor","aoid":null,"title":"The CancelToken Constructor","number":"3.1","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"The CancelToken Constructor"},{"type":"clause","id":"sec-canceltoken-constructor-definition","aoid":null,"title":"CancelToken ( _executor_ )","number":"3.1.1","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"CancelToken ( _executor_ )"},{"type":"clause","id":"sec-canceler-functions","aoid":null,"title":"Canceler Functions","number":"3.1.1.1","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Canceler Functions"},{"type":"clause","id":"sec-properties-of-the-canceltoken-constructor","aoid":null,"title":"Properties of the CancelToken Constructor","number":"3.2","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Properties of the CancelToken Constructor"},{"type":"clause","id":"sec-canceltoken.source","aoid":null,"title":"CancelToken.source()","number":"3.2.1","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"CancelToken.source()"},{"type":"clause","id":"sec-getcancelexecutor-functions","aoid":null,"title":"GetCancelExecutor Functions","number":"3.2.1.1","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"GetCancelExecutor Functions"},{"type":"clause","id":"sec-canceltoken.prototype","aoid":null,"title":"CancelToken.prototype","number":"3.2.2","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"CancelToken.prototype"},{"type":"clause","id":"sec-properties-of-the-canceltoken-prototype-object","aoid":null,"title":"Properties of the CancelToken Prototype Object","number":"3.3","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Properties of the CancelToken Prototype Object"},{"type":"clause","id":"sec-canceltoken.prototype.throwifrequested","aoid":null,"title":"CancelToken.prototype.throwIfRequested ( )","number":"3.3.1","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"CancelToken.prototype.throwIfRequested ( )"},{"type":"clause","id":"sec-canceltoken.prototype.constructor","aoid":null,"title":"CancelToken.prototype.constructor","number":"3.3.2","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"CancelToken.prototype.constructor"},{"type":"clause","id":"sec-canceltoken.prototype.promise","aoid":null,"title":"get CancelToken.prototype.promise","number":"3.3.3","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"get CancelToken.prototype.promise"},{"type":"clause","id":"sec-canceltoken.prototype.requested","aoid":null,"title":"get CancelToken.prototype.requested","number":"3.3.4","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"get CancelToken.prototype.requested"},{"type":"clause","id":"sec-canceltoken.prototype-@@tostringtag","aoid":null,"title":"CancelToken.prototype [ @@toStringTag ]","number":"3.3.5","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"CancelToken.prototype [ @@toStringTag ]"},{"type":"clause","id":"sec-properties-of-canceltoken-instances","aoid":null,"title":"Properties of CancelToken Instances","number":"3.4","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Properties of CancelToken Instances"},{"type":"clause","id":"sec-ecmascript-language-statements-and-declarations","aoid":null,"title":"ECMAScript Language: Statements and Declarations","number":"4","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"ECMAScript Language: Statements and Declarations"},{"type":"clause","id":"sec-try-statement","aoid":null,"title":"The `try` Statement","number":"4.1","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"The `try` Statement"},{"type":"clause","id":"sec-try-statement-static-semantics-early-errors","aoid":null,"title":"Static Semantics: Early Errors","number":"4.1.1","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Static Semantics: Early Errors"},{"type":"clause","id":"sec-try-statement-static-semantics-containsduplicatelabels","aoid":null,"title":"Static Semantics: ContainsDuplicateLabels","number":"4.1.2","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Static Semantics: ContainsDuplicateLabels"},{"type":"clause","id":"sec-try-statement-static-semantics-containsundefinedbreaktarget","aoid":null,"title":"Static Semantics: ContainsUndefinedBreakTarget","number":"4.1.3","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Static Semantics: ContainsUndefinedBreakTarget"},{"type":"clause","id":"sec-try-statement-static-semantics-containsundefinedcontinuetarget","aoid":null,"title":"Static Semantics: ContainsUndefinedContinueTarget","number":"4.1.4","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Static Semantics: ContainsUndefinedContinueTarget"},{"type":"clause","id":"sec-try-statement-static-semantics-vardeclarednames","aoid":null,"title":"Static Semantics: VarDeclaredNames","number":"4.1.5","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Static Semantics: VarDeclaredNames"},{"type":"clause","id":"sec-try-statement-static-semantics-varscopeddeclarations","aoid":null,"title":"Static Semantics: VarScopedDeclarations","number":"4.1.6","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Static Semantics: VarScopedDeclarations"},{"type":"clause","id":"sec-runtime-semantics-catchclauseevaluation","aoid":null,"title":"Runtime Semantics: CatchClauseEvaluation","number":"4.1.7","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Runtime Semantics: CatchClauseEvaluation"},{"type":"clause","id":"sec-try-statement-runtime-semantics-evaluation","aoid":null,"title":"Runtime Semantics: Evaluation","number":"4.1.8","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Runtime Semantics: Evaluation"},{"type":"production","id":"prod-TryStatement","name":"TryStatement","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"TryStatement"},{"type":"production","id":"prod-Catch","name":"Catch","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Catch"},{"type":"production","id":"prod-Else","name":"Else","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Else"},{"type":"production","id":"prod-Finally","name":"Finally","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Finally"},{"type":"production","id":"prod-CatchParameter","name":"CatchParameter","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"CatchParameter"},{"type":"table","id":"table-58","number":1,"caption":"Table 1: PromiseReaction Record Fields","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Table 1: PromiseReaction Record Fields"},{"type":"table","id":"table-canceltoken-internal-slots","number":2,"caption":"Table 2: Internal Slots of CancelToken Instances","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"Table 2: Internal Slots of CancelToken Instances"},{"type":"term","term":"%PromisePrototype%","refId":"sec-properties-of-the-promise-prototype-object","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"%PromisePrototype%"},{"type":"term","term":"%Cancel%","refId":"sec-cancel-constructor","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"%Cancel%"},{"type":"term","term":"%CancelPrototype%","refId":"sec-properties-of-the-cancel-prototype-object","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"%CancelPrototype%"},{"type":"term","term":"%CancelToken%","refId":"sec-canceltoken-constructor","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"%CancelToken%"},{"type":"term","term":"%CancelTokenPrototype%","refId":"sec-properties-of-the-canceltoken-prototype-object","namespace":"https://domenic.github.io/cancelable-promise/","location":"","key":"%CancelTokenPrototype%"}]</script></head><body><div id="menu-toggle">☰</div><div id="menu"><div id="menu-search"><input type="text" id="menu-search-box" placeholder="Search..."><div id="menu-search-results" class="inactive"></div></div><div id="menu-toc"><ol class="toc"><li><span class="item-toggle-none"></span><a href="#" title="Introduction"><span class="secnum"></span> Introduction</a></li><li><span class="item-toggle">◢</span><a href="#sec-promise-objects" title="Promise Objects"><span class="secnum">1</span> Promise Objects</a><ol class="toc"><li><span class="item-toggle">◢</span><a href="#sec-promise-abstract-operations" title="Promise Abstract Operations"><span class="secnum">1.1</span> Promise Abstract Operations</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#sec-promisereaction-records" title="PromiseReaction Records"><span class="secnum">1.1.1</span> PromiseReaction Records</a></li><li><span class="item-toggle-none"></span><a href="#sec-promise-resolve-functions" title="Promise Resolve Functions"><span class="secnum">1.1.2</span> Promise Resolve Functions</a></li><li><span class="item-toggle-none"></span><a href="#sec-resolvepromise" title="ResolvePromise ( _promise_, _resolution_ )"><span class="secnum">1.1.3</span> ResolvePromise ( <var>promise</var>, <var>resolution</var> )</a></li><li><span class="item-toggle-none"></span><a href="#sec-rejectpromise" title="RejectPromise ( _promise_, _reason_ )"><span class="secnum">1.1.4</span> RejectPromise ( <var>promise</var>, <var>reason</var> )</a></li><li><span class="item-toggle-none"></span><a href="#sec-host-promise-rejection-tracker" title="HostPromiseRejectionTracker ( _promise_, _operation_ )"><span class="secnum">1.1.5</span> HostPromiseRejectionTracker ( <var>promise</var>, <var>operation</var> )</a></li></ol></li><li><span class="item-toggle">◢</span><a href="#sec-promise-jobs" title="Promise Jobs"><span class="secnum">1.2</span> Promise Jobs</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#sec-promisereactionjob" title="PromiseReactionJob ( _reaction_, _argument_ )"><span class="secnum">1.2.1</span> PromiseReactionJob ( <var>reaction</var>, <var>argument</var> )</a></li></ol></li><li><span class="item-toggle">◢</span><a href="#sec-properties-of-the-promise-prototype-object" title="Properties of the Promise Prototype Object"><span class="secnum">1.3</span> Properties of the Promise Prototype Object</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#sec-promise.prototype.else" title="Promise.prototype.else ( _onErrored_ )"><span class="secnum">1.3.1</span> Promise.prototype.else ( <var>onErrored</var> )</a></li></ol></li><li><span class="item-toggle">◢</span><a href="#sec-promise.prototype.then" title="Promise.prototype.then ( _onFulfilled_, _onRejected_ )"><span class="secnum">1.4</span> Promise.prototype.then ( <var>onFulfilled</var>, <var>onRejected</var> )</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#sec-performpromisethen" title="PerformPromiseThen ( _promise_, _onFulfilled_, _onRejected_, _resultCapability_, _rejectReactionType_ )"><span class="secnum">1.4.1</span> PerformPromiseThen ( <var>promise</var>, <var>onFulfilled</var>, <var>onRejected</var>, <var>resultCapability</var>, <var>rejectReactionType</var> )</a></li></ol></li></ol></li><li><span class="item-toggle">◢</span><a href="#sec-cancel-objects" title="Cancel Objects"><span class="secnum">2</span> Cancel Objects</a><ol class="toc"><li><span class="item-toggle">◢</span><a href="#sec-cancel-constructor" title="The Cancel Constructor"><span class="secnum">2.1</span> The Cancel Constructor</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#sec-cancel-message" title="Cancel ( _message_ )"><span class="secnum">2.1.1</span> Cancel ( <var>message</var> )</a></li></ol></li><li><span class="item-toggle">◢</span><a href="#sec-properties-of-the-cancel-constructor" title="Properties of the Cancel Constructor"><span class="secnum">2.2</span> Properties of the Cancel Constructor</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#sec-cancel.prototype" title="Cancel.prototype"><span class="secnum">2.2.1</span> Cancel.prototype</a></li></ol></li><li><span class="item-toggle">◢</span><a href="#sec-properties-of-the-cancel-prototype-object" title="Properties of the Cancel Prototype Object"><span class="secnum">2.3</span> Properties of the Cancel Prototype Object</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#sec-cancel.prototype.constructor" title="Cancel.prototype.constructor"><span class="secnum">2.3.1</span> Cancel.prototype.constructor</a></li><li><span class="item-toggle-none"></span><a href="#sec-cancel.prototype.tostring" title="Cancel.prototype.toString ( )"><span class="secnum">2.3.2</span> Cancel.prototype.toString ( )</a></li></ol></li><li><span class="item-toggle-none"></span><a href="#sec-properties-of-cancel-instances" title="Properties of Cancel Instances"><span class="secnum">2.4</span> Properties of Cancel Instances</a></li></ol></li><li><span class="item-toggle">◢</span><a href="#sec-canceltoken-objects" title="CancelToken Objects"><span class="secnum">3</span> CancelToken Objects</a><ol class="toc"><li><span class="item-toggle">◢</span><a href="#sec-canceltoken-constructor" title="The CancelToken Constructor"><span class="secnum">3.1</span> The CancelToken Constructor</a><ol class="toc"><li><span class="item-toggle">◢</span><a href="#sec-canceltoken-constructor-definition" title="CancelToken ( _executor_ )"><span class="secnum">3.1.1</span> CancelToken ( <var>executor</var> )</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#sec-canceler-functions" title="Canceler Functions"><span class="secnum">3.1.1.1</span> Canceler Functions</a></li></ol></li></ol></li><li><span class="item-toggle">◢</span><a href="#sec-properties-of-the-canceltoken-constructor" title="Properties of the CancelToken Constructor"><span class="secnum">3.2</span> Properties of the CancelToken Constructor</a><ol class="toc"><li><span class="item-toggle">◢</span><a href="#sec-canceltoken.source" title="CancelToken.source()"><span class="secnum">3.2.1</span> CancelToken.source()</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#sec-getcancelexecutor-functions" title="GetCancelExecutor Functions"><span class="secnum">3.2.1.1</span> GetCancelExecutor Functions</a></li></ol></li><li><span class="item-toggle-none"></span><a href="#sec-canceltoken.prototype" title="CancelToken.prototype"><span class="secnum">3.2.2</span> CancelToken.prototype</a></li></ol></li><li><span class="item-toggle">◢</span><a href="#sec-properties-of-the-canceltoken-prototype-object" title="Properties of the CancelToken Prototype Object"><span class="secnum">3.3</span> Properties of the CancelToken Prototype Object</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#sec-canceltoken.prototype.throwifrequested" title="CancelToken.prototype.throwIfRequested ( )"><span class="secnum">3.3.1</span> CancelToken.prototype.throwIfRequested ( )</a></li><li><span class="item-toggle-none"></span><a href="#sec-canceltoken.prototype.constructor" title="CancelToken.prototype.constructor"><span class="secnum">3.3.2</span> CancelToken.prototype.constructor</a></li><li><span class="item-toggle-none"></span><a href="#sec-canceltoken.prototype.promise" title="get CancelToken.prototype.promise"><span class="secnum">3.3.3</span> get CancelToken.prototype.promise</a></li><li><span class="item-toggle-none"></span><a href="#sec-canceltoken.prototype.requested" title="get CancelToken.prototype.requested"><span class="secnum">3.3.4</span> get CancelToken.prototype.requested</a></li><li><span class="item-toggle-none"></span><a href="#sec-canceltoken.prototype-@@tostringtag" title="CancelToken.prototype [ @@toStringTag ]"><span class="secnum">3.3.5</span> CancelToken.prototype [ @@toStringTag ]</a></li></ol></li><li><span class="item-toggle-none"></span><a href="#sec-properties-of-canceltoken-instances" title="Properties of CancelToken Instances"><span class="secnum">3.4</span> Properties of CancelToken Instances</a></li></ol></li><li><span class="item-toggle">◢</span><a href="#sec-ecmascript-language-statements-and-declarations" title="ECMAScript Language: Statements and Declarations"><span class="secnum">4</span> ECMAScript Language: Statements and Declarations</a><ol class="toc"><li><span class="item-toggle">◢</span><a href="#sec-try-statement" title="The `try` Statement"><span class="secnum">4.1</span> The <code>try</code> Statement</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#sec-try-statement-static-semantics-early-errors" title="Static Semantics: Early Errors"><span class="secnum">4.1.1</span> SS: Early Errors</a></li><li><span class="item-toggle-none"></span><a href="#sec-try-statement-static-semantics-containsduplicatelabels" title="Static Semantics: ContainsDuplicateLabels"><span class="secnum">4.1.2</span> SS: ContainsDuplicateLabels</a></li><li><span class="item-toggle-none"></span><a href="#sec-try-statement-static-semantics-containsundefinedbreaktarget" title="Static Semantics: ContainsUndefinedBreakTarget"><span class="secnum">4.1.3</span> SS: ContainsUndefinedBreakTarget</a></li><li><span class="item-toggle-none"></span><a href="#sec-try-statement-static-semantics-containsundefinedcontinuetarget" title="Static Semantics: ContainsUndefinedContinueTarget"><span class="secnum">4.1.4</span> SS: ContainsUndefinedContinueTarget</a></li><li><span class="item-toggle-none"></span><a href="#sec-try-statement-static-semantics-vardeclarednames" title="Static Semantics: VarDeclaredNames"><span class="secnum">4.1.5</span> SS: VarDeclaredNames</a></li><li><span class="item-toggle-none"></span><a href="#sec-try-statement-static-semantics-varscopeddeclarations" title="Static Semantics: VarScopedDeclarations"><span class="secnum">4.1.6</span> SS: VarScopedDeclarations</a></li><li><span class="item-toggle-none"></span><a href="#sec-runtime-semantics-catchclauseevaluation" title="Runtime Semantics: CatchClauseEvaluation"><span class="secnum">4.1.7</span> RS: CatchClauseEvaluation</a></li><li><span class="item-toggle-none"></span><a href="#sec-try-statement-runtime-semantics-evaluation" title="Runtime Semantics: Evaluation"><span class="secnum">4.1.8</span> RS: Evaluation</a></li></ol></li></ol></li></ol></div></div><h1 class="version">Stage 1 Draft / August 10, 2016</h1><h1 class="title">Cancelable Promises</h1>
<script src="https://bterlson.github.io/ecmarkup/ecmarkup.js" defer=""></script>
<link rel="stylesheet" href="https://bterlson.github.io/ecmarkup/elements.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/solarized_light.min.css">

<emu-intro>
  <h1><span class="secnum"></span>Introduction<span class="utils"><span class="anchor"><a href="#">#</a></span></span></h1>

  <p>Background explanatory material for this specification can be found in the  <a href="https://github.com/domenic/cancelable-promise">domenic/cancelable-promise</a> repository. See also the  <a href="https://github.com/domenic/cancelable-promise/issues">issues</a>, which contain many ongoing discussions and debates.</p>
</emu-intro>

<emu-clause id="sec-promise-objects">
  <h1><span class="secnum">1</span>Promise Objects<span class="utils"><span class="anchor"><a href="#sec-promise-objects">#</a></span></span></h1>

  <p>A Promise is an object that is used as a placeholder for the eventual results of a deferred (and possibly asynchronous) computation.</p>
  <p>Any Promise object is in one of three mutually exclusive states:  <em>fulfilled</em>,  <em>rejected</em>, and  <em>pending</em>:</p>
  <ul>
    <li>
      A promise <code>p</code> is fulfilled if <code>p.then(f, r)</code> will immediately enqueue a Job to call the function <code>f</code>.
    
    </li>
    <li>
      A promise <code>p</code> is rejected if <code>p.then(f, r)</code> will immediately enqueue a Job to call the function <code>r</code>.
    
    </li>
    <li>
      A promise is pending if it is neither fulfilled nor rejected.
    
    </li>
  </ul>
  <p>A promise is said to be  <em>settled</em> if it is not pending, i.e. if it is either fulfilled or rejected.</p>
  <p>A promise is  <em>resolved</em> if it is settled or if it has been “locked in” to match the state of another promise. Attempting to resolve or reject a resolved promise has no effect. A promise is  <em>unresolved</em> if it is not resolved. An unresolved promise is always in the pending state. A resolved promise may be pending, fulfilled or rejected.</p>

  <p><ins>A rejected promise is  <em>canceled</em> if its rejection reason has a [[CancelBrand]] internal slot, and is  <em>errored</em> otherwise.</ins></p>

  <emu-clause id="sec-promise-abstract-operations">
    <h1><span class="secnum">1.1</span>Promise Abstract Operations<span class="utils"><span class="anchor"><a href="#sec-promise-abstract-operations">#</a></span></span></h1>

    <emu-clause id="sec-promisereaction-records">
      <h1><span class="secnum">1.1.1</span>PromiseReaction Records<span class="utils"><span class="anchor"><a href="#sec-promisereaction-records">#</a></span></span></h1>
      <p>The PromiseReaction is a <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref> value used to store information about how a promise should react when it becomes resolved or rejected with a given value. PromiseReaction records are created by the <emu-xref aoid="PerformPromiseThen"><a href="#sec-performpromisethen">PerformPromiseThen</a></emu-xref> abstract operation, and are used by a <emu-xref aoid="PromiseReactionJob"><a href="#sec-promisereactionjob">PromiseReactionJob</a></emu-xref>.</p>
      <p>PromiseReaction records have the fields listed in  <emu-xref href="#table-58"><a href="#table-58">Table 1</a></emu-xref>.</p>
      <emu-table id="table-58" caption="PromiseReaction Record Fields"><figure><figcaption>Table 1: PromiseReaction <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref> Fields</figcaption>
        <table>
          <tbody>
          <tr>
            <th>
              Field Name
            
            </th>
            <th>
              Value
            
            </th>
            <th>
              Meaning
            
            </th>
          </tr>
          <tr>
            <td>
              [[Capability]]
            
            </td>
            <td>
              A PromiseCapability <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref>
            
            </td>
            <td>
              The capabilities of the promise for which this record provides a reaction handler.
            
            </td>
          </tr>
          <tr>
            <td>
              [[Type]]
            
            </td>
            <td>
              Either <code>"Fulfill"</code><del> or <code>"Reject"</code></del><ins>, <code>"Reject"</code>, or <code>"Else"</code></ins>.
            
            </td>
            <td>
              The [[Type]] is used when [[Handler]] is <emu-val>undefined</emu-val> to allow for behavior specific to the settlement type.
            
            </td>
          </tr>
          <tr>
            <td>
              [[Handler]]
            
            </td>
            <td>
              A function object or <emu-val>undefined</emu-val>.
            
            </td>
            <td>
              The function that should be applied to the incoming value, and whose return value will govern what happens to the derived promise. If [[Handler]] is <emu-val>undefined</emu-val>, a function that depends on the value of [[Type]] will be used instead.
            
            </td>
          </tr>
          </tbody>
        </table>
      </figure></emu-table>
    </emu-clause>

    <emu-clause id="sec-promise-resolve-functions">
      <h1><span class="secnum">1.1.2</span>Promise Resolve Functions<span class="utils"><span class="anchor"><a href="#sec-promise-resolve-functions">#</a></span></span></h1>
      <p>A promise resolve function is an anonymous built-in function that has [[Promise]] and [[AlreadyResolved]] internal slots.</p>
      <p>When a promise resolve function <var>F</var> is called with argument <var>resolution</var>, the following steps are taken:</p>
      <emu-alg><ol><li>Assert: <var>F</var> has a [[Promise]] internal slot whose value is an Object.</li><li>Let <var>promise</var> be <var>F</var>.[[Promise]].</li><li>Let <var>alreadyResolved</var> be <var>F</var>.[[AlreadyResolved]].</li><li>If <var>alreadyResolved</var>.[[Value]] is <emu-val>true</emu-val>, return <emu-val>undefined</emu-val>.</li><li>Set <var>alreadyResolved</var>.[[Value]] to <emu-val>true</emu-val>.</li><li><ins>Return <emu-xref aoid="ResolvePromise"><a href="#sec-resolvepromise">ResolvePromise</a></emu-xref>(<var>promise</var>, <var>resolution</var>).</ins></li><li><del>(all previous steps have been moved to that abstract operation)</del>
      </li></ol></emu-alg>
      <p>The <code>length</code> property of a promise resolve function is 1.</p>
    </emu-clause>

    <emu-clause id="sec-resolvepromise" aoid="ResolvePromise">
      <h1><span class="secnum">1.1.3</span><ins>ResolvePromise ( <var>promise</var>, <var>resolution</var> )</ins><span class="utils"><span class="anchor"><a href="#sec-resolvepromise">#</a></span></span></h1>

      <p>When the ResolvePromise abstract operation is called with arguments <var>promise</var> and <var>resolution</var>, the following steps are taken:</p>

      <emu-alg><ol><li>If <emu-xref aoid="SameValue"><a href="https://tc39.github.io/ecma262/#sec-samevalue">SameValue</a></emu-xref>(<var>resolution</var>, <var>promise</var>) is <emu-val>true</emu-val>, then<ol><li>Let <var>selfResolutionError</var> be a newly created <emu-val>TypeError</emu-val> object.</li><li>Return <emu-xref aoid="RejectPromise"><a href="#sec-rejectpromise">RejectPromise</a></emu-xref>(<var>promise</var>, <var>selfResolutionError</var>).</li></ol></li><li>If <emu-xref aoid="Type"><a href="https://tc39.github.io/ecma262/#sec-ecmascript-data-types-and-values">Type</a></emu-xref>(<var>resolution</var>) is not Object, then<ol><li>Return <emu-xref aoid="FulfillPromise"><a href="https://tc39.github.io/ecma262/#sec-fulfillpromise">FulfillPromise</a></emu-xref>(<var>promise</var>, <var>resolution</var>).</li></ol></li><li>Let <var>then</var> be <emu-xref aoid="Get"><a href="https://tc39.github.io/ecma262/#sec-get-o-p">Get</a></emu-xref>(<var>resolution</var>, <code>"then"</code>).</li><li>If <var>then</var> is an <emu-xref href="#sec-completion-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-completion-record-specification-type">abrupt completion</a></emu-xref>, then<ol><li>Return <emu-xref aoid="RejectPromise"><a href="#sec-rejectpromise">RejectPromise</a></emu-xref>(<var>promise</var>, <var>then</var>.[[Value]]).</li></ol></li><li>Let <var>thenAction</var> be <var>then</var>.[[Value]].</li><li>If <emu-xref aoid="IsCallable"><a href="https://tc39.github.io/ecma262/#sec-iscallable">IsCallable</a></emu-xref>(<var>thenAction</var>) is <emu-val>false</emu-val>, then<ol><li>Return <emu-xref aoid="FulfillPromise"><a href="https://tc39.github.io/ecma262/#sec-fulfillpromise">FulfillPromise</a></emu-xref>(<var>promise</var>, <var>resolution</var>).</li></ol></li><li>Perform <emu-xref aoid="EnqueueJob"><a href="https://tc39.github.io/ecma262/#sec-enqueuejob">EnqueueJob</a></emu-xref>(<code>"PromiseJobs"</code>, <emu-xref aoid="PromiseResolveThenableJob"><a href="https://tc39.github.io/ecma262/#sec-promiseresolvethenablejob">PromiseResolveThenableJob</a></emu-xref>, « <var>promise</var>, <var>resolution</var>, <var>thenAction</var> »).
      </li></ol></emu-alg>
    </emu-clause>

    <emu-clause id="sec-rejectpromise" aoid="RejectPromise">
      <h1><span class="secnum">1.1.4</span>RejectPromise ( <var>promise</var>, <var>reason</var> )<span class="utils"><span class="anchor"><a href="#sec-rejectpromise">#</a></span></span></h1>
      <p>When the RejectPromise abstract operation is called with arguments <var>promise</var> and <var>reason</var>, the following steps are taken:</p>
      <emu-alg><ol><li>Assert: The value of <var>promise</var>.[[PromiseState]] is <code>"pending"</code>.</li><li>Let <var>reactions</var> be <var>promise</var>.[[PromiseRejectReactions]].</li><li>Set <var>promise</var>.[[PromiseResult]] to <var>reason</var>.</li><li>Set <var>promise</var>.[[PromiseFulfillReactions]] to <emu-val>undefined</emu-val>.</li><li>Set <var>promise</var>.[[PromiseRejectReactions]] to <emu-val>undefined</emu-val>.</li><li>Set <var>promise</var>.[[PromiseState]] to <code>"rejected"</code>.</li><li>If <var>promise</var>.[[PromiseIsHandled]] is <emu-val>false</emu-val><ins> and <var>reason</var> has no [[CancelBrand]] internal slot</ins>, perform <emu-xref aoid="HostPromiseRejectionTracker"><a href="#sec-host-promise-rejection-tracker">HostPromiseRejectionTracker</a></emu-xref>(<var>promise</var>, <code>"reject"</code>).</li><li>Return <emu-xref aoid="TriggerPromiseReactions"><a href="https://tc39.github.io/ecma262/#sec-triggerpromisereactions">TriggerPromiseReactions</a></emu-xref>(<var>reactions</var>, <var>reason</var>).
      </li></ol></emu-alg>
    </emu-clause>

    <emu-clause id="sec-host-promise-rejection-tracker" aoid="HostPromiseRejectionTracker">
      <h1><span class="secnum">1.1.5</span>HostPromiseRejectionTracker ( <var>promise</var>, <var>operation</var> )<span class="utils"><span class="anchor"><a href="#sec-host-promise-rejection-tracker">#</a></span></span></h1>

      <p>HostPromiseRejectionTracker is an implementation-defined abstract operation that allows host environments to track promise rejections.</p>

      <p>An implementation of HostPromiseRejectionTracker must complete normally in all cases. The default implementation of HostPromiseRejectionTracker is to unconditionally return an empty normal completion.</p>

      <emu-note><span class="note">Note 1</span>
        <p>HostPromiseRejectionTracker is called in two scenarios:</p>

        <ul>
          <li>When a promise is rejected  <ins>with an object that is not a <code>Cancel</code> instance  </ins>without any handlers, it is called with its <var>operation</var> argument set to <code>"reject"</code>.</li>
          <li>When a handler is added to  <ins>such  </ins>a rejected promise for the first time, it is called with its <var>operation</var> argument set to <code>"handle"</code>.</li>
        </ul>

        <p>A typical implementation of HostPromiseRejectionTracker might try to notify developers of unhandled rejections, while also being careful to notify them if such previous notifications are later invalidated by new handlers being attached.</p>
      </emu-note>

      <emu-note><span class="note">Note 2</span>
        <p>If <var>operation</var> is <code>"handle"</code>, an implementation should not hold a reference to <var>promise</var> in a way that would interfere with garbage collection. An implementation may hold a reference to <var>promise</var> if <var>operation</var> is <code>"reject"</code>, since it is expected that rejections will be rare and not on hot code paths.</p>
      </emu-note>
    </emu-clause>
  </emu-clause>

  <emu-clause id="sec-promise-jobs">
    <h1><span class="secnum">1.2</span>Promise Jobs<span class="utils"><span class="anchor"><a href="#sec-promise-jobs">#</a></span></span></h1>

    <emu-clause id="sec-promisereactionjob" aoid="PromiseReactionJob">
      <h1><span class="secnum">1.2.1</span>PromiseReactionJob ( <var>reaction</var>, <var>argument</var> )<span class="utils"><span class="anchor"><a href="#sec-promisereactionjob">#</a></span></span></h1>
      <p>The job PromiseReactionJob with parameters <var>reaction</var> and <var>argument</var> applies the appropriate handler to the incoming value, and uses the handler's return value to resolve or reject the derived promise associated with that handler.</p>
      <emu-alg><ol><li>Assert: <var>reaction</var> is a PromiseReaction <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref>.</li><li>Let <var>promiseCapability</var> be <var>reaction</var>.[[Capability]].</li><li>Let <var>type</var> be <var>reaction</var>.[[Type]].</li><li>Let <var>handler</var> be <var>reaction</var>.[[Handler]].</li><li><ins>If <var>type</var> is <code>"Else"</code> and <var>argument</var> has a [[CancelBrand]] internal slot, set <var>handler</var> to <emu-val>undefined</emu-val>.</ins></li><li>If <var>handler</var> is <emu-val>undefined</emu-val>, then<ol><li>If <var>type</var> is <code>"Fulfill"</code>, let <var>handlerResult</var> be <emu-xref aoid="NormalCompletion"><a href="https://tc39.github.io/ecma262/#sec-normalcompletion">NormalCompletion</a></emu-xref>(<var>argument</var>).</li><li>Otherwise, <var>type</var> is <code>"Reject"</code><ins> or <code>"Else"</code></ins>. Let <var>handlerResult</var> be <emu-xref aoid="Completion"><a href="https://tc39.github.io/ecma262/#sec-completion-record-specification-type">Completion</a></emu-xref> {[[Type]]: <emu-const>throw</emu-const>, [[Value]]: <var>argument</var>, [[Target]]: <emu-const>empty</emu-const>}.</li></ol></li><li>Else, let <var>handlerResult</var> be <emu-xref aoid="Call"><a href="https://tc39.github.io/ecma262/#sec-call">Call</a></emu-xref>(<var>handler</var>, <emu-val>undefined</emu-val>, « <var>argument</var> »).</li><li>If <var>handlerResult</var> is an <emu-xref href="#sec-completion-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-completion-record-specification-type">abrupt completion</a></emu-xref>, then<ol><li>Let <var>status</var> be <emu-xref aoid="Call"><a href="https://tc39.github.io/ecma262/#sec-call">Call</a></emu-xref>(<var>promiseCapability</var>.[[Reject]], <emu-val>undefined</emu-val>, « <var>handlerResult</var>.[[Value]] »).</li></ol></li><li>Else,<ol><li>Let <var>status</var> be <emu-xref aoid="Call"><a href="https://tc39.github.io/ecma262/#sec-call">Call</a></emu-xref>(<var>promiseCapability</var>.[[Resolve]], <emu-val>undefined</emu-val>, « <var>handlerResult</var>.[[Value]] »).</li></ol></li><li>Return <emu-xref aoid="Completion"><a href="https://tc39.github.io/ecma262/#sec-completion-record-specification-type">Completion</a></emu-xref>(<var>status</var>).
      </li></ol></emu-alg>
    </emu-clause>
  </emu-clause>

  <emu-clause id="sec-properties-of-the-promise-prototype-object">
    <h1><span class="secnum">1.3</span>Properties of the Promise Prototype Object<span class="utils"><span class="anchor"><a href="#sec-properties-of-the-promise-prototype-object">#</a></span></span></h1>
    <p>The Promise prototype object is the intrinsic object  <dfn>%PromisePrototype%</dfn>. The value of the [[Prototype]] internal slot of the Promise prototype object is the intrinsic object <emu-xref href="#sec-properties-of-the-object-prototype-object"><a href="https://tc39.github.io/ecma262/#sec-properties-of-the-object-prototype-object">%ObjectPrototype%</a></emu-xref>. The Promise prototype object is an ordinary object. It does not have a [[PromiseState]] internal slot or any of the other internal slots of Promise instances.</p>

    <emu-clause id="sec-promise.prototype.else">
      <h1><span class="secnum">1.3.1</span><ins>Promise.prototype.else ( <var>onErrored</var> )</ins><span class="utils"><span class="anchor"><a href="#sec-promise.prototype.else">#</a></span></span></h1>
      <p>When the <code>else</code> method is called with argument <var>onErrored</var>, the following steps are taken:</p>
      <emu-alg><ol><li>Let <var>promise</var> be the <emu-val>this</emu-val> value.</li><li>If <emu-xref aoid="IsPromise"><a href="https://tc39.github.io/ecma262/#sec-ispromise">IsPromise</a></emu-xref>(<var>promise</var>) is <emu-val>false</emu-val>, throw a <emu-val>TypeError</emu-val> exception.</li><li>Let <var>C</var> be ? <emu-xref aoid="SpeciesConstructor"><a href="https://tc39.github.io/ecma262/#sec-speciesconstructor">SpeciesConstructor</a></emu-xref>(<var>promise</var>, <emu-xref href="#sec-promise-constructor"><a href="https://tc39.github.io/ecma262/#sec-promise-constructor">%Promise%</a></emu-xref>).</li><li>Let <var>resultCapability</var> be ? <emu-xref aoid="NewPromiseCapability"><a href="https://tc39.github.io/ecma262/#sec-newpromisecapability">NewPromiseCapability</a></emu-xref>(<var>C</var>).</li><li>Return <emu-xref aoid="PerformPromiseThen"><a href="#sec-performpromisethen">PerformPromiseThen</a></emu-xref>(<var>promise</var>, <emu-val>undefined</emu-val>, <var>onErrored</var>, <var>resultCapability</var><ins>, <code>"Else"</code></ins>).
      </li></ol></emu-alg>
      </emu-clause>
    </emu-clause>

    <emu-clause id="sec-promise.prototype.then">
      <h1><span class="secnum">1.4</span>Promise.prototype.then ( <var>onFulfilled</var>, <var>onRejected</var> )<span class="utils"><span class="anchor"><a href="#sec-promise.prototype.then">#</a></span></span></h1>
      <p>When the <code>then</code> method is called with arguments <var>onFulfilled</var> and <var>onRejected</var>, the following steps are taken:</p>
      <emu-alg><ol><li>Let <var>promise</var> be the <emu-val>this</emu-val> value.</li><li>If <emu-xref aoid="IsPromise"><a href="https://tc39.github.io/ecma262/#sec-ispromise">IsPromise</a></emu-xref>(<var>promise</var>) is <emu-val>false</emu-val>, throw a <emu-val>TypeError</emu-val> exception.</li><li>Let <var>C</var> be ? <emu-xref aoid="SpeciesConstructor"><a href="https://tc39.github.io/ecma262/#sec-speciesconstructor">SpeciesConstructor</a></emu-xref>(<var>promise</var>, <emu-xref href="#sec-promise-constructor"><a href="https://tc39.github.io/ecma262/#sec-promise-constructor">%Promise%</a></emu-xref>).</li><li>Let <var>resultCapability</var> be ? <emu-xref aoid="NewPromiseCapability"><a href="https://tc39.github.io/ecma262/#sec-newpromisecapability">NewPromiseCapability</a></emu-xref>(<var>C</var>).</li><li>Return <emu-xref aoid="PerformPromiseThen"><a href="#sec-performpromisethen">PerformPromiseThen</a></emu-xref>(<var>promise</var>, <var>onFulfilled</var>, <var>onRejected</var>, <var>resultCapability</var><ins>, <code>"Rejected"</code></ins>).
      </li></ol></emu-alg>

      <!-- es6num="25.4.5.3.1" -->
      <emu-clause id="sec-performpromisethen" aoid="PerformPromiseThen">
        <h1><span class="secnum">1.4.1</span>PerformPromiseThen ( <var>promise</var>, <var>onFulfilled</var>, <var>onRejected</var>, <var>resultCapability</var><ins>, <var>rejectReactionType</var></ins> )<span class="utils"><span class="anchor"><a href="#sec-performpromisethen">#</a></span></span></h1>
        <p>The abstract operation PerformPromiseThen performs the “then” operation on <var>promise</var> using <var>onFulfilled</var> and <var>onRejected</var> as its settlement actions<ins> (with <var>onRejected</var>'s behavior being further modified by <var>rejectReactionType</var>)</ins>. The result is <var>resultCapability</var>'s promise.</p>
        <emu-alg><ol><li>Assert: <emu-xref aoid="IsPromise"><a href="https://tc39.github.io/ecma262/#sec-ispromise">IsPromise</a></emu-xref>(<var>promise</var>) is <emu-val>true</emu-val>.</li><li>Assert: <var>resultCapability</var> is a PromiseCapability <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref>.</li><li>If <emu-xref aoid="IsCallable"><a href="https://tc39.github.io/ecma262/#sec-iscallable">IsCallable</a></emu-xref>(<var>onFulfilled</var>) is <emu-val>false</emu-val>, then<ol><li>Let <var>onFulfilled</var> be <emu-val>undefined</emu-val>.</li></ol></li><li>If <emu-xref aoid="IsCallable"><a href="https://tc39.github.io/ecma262/#sec-iscallable">IsCallable</a></emu-xref>(<var>onRejected</var>) is <emu-val>false</emu-val>, then<ol><li>Let <var>onRejected</var> be <emu-val>undefined</emu-val>.</li></ol></li><li>Let <var>fulfillReaction</var> be the PromiseReaction { [[Capability]]: <var>resultCapability</var>, [[Type]]: <code>"Fulfill"</code>, [[Handler]]: <var>onFulfilled</var> }.</li><li>Let <var>rejectReaction</var> be the PromiseReaction { [[Capability]]: <var>resultCapability</var>, [[Type]]: <del><code>"Reject"</code></del><ins><var>rejectReactionType</var></ins>, [[Handler]]: <var>onRejected</var> }.</li><li>If <var>promise</var>.[[PromiseState]] is <code>"pending"</code>, then<ol><li>Append <var>fulfillReaction</var> as the last element of the <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref> that is <var>promise</var>.[[PromiseFulfillReactions]].</li><li>Append <var>rejectReaction</var> as the last element of the <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref> that is <var>promise</var>.[[PromiseRejectReactions]].</li></ol></li><li>Else if <var>promise</var>.[[PromiseState]] is <code>"fulfilled"</code>, then<ol><li>Let <var>value</var> be <var>promise</var>.[[PromiseResult]].</li><li>Perform <emu-xref aoid="EnqueueJob"><a href="https://tc39.github.io/ecma262/#sec-enqueuejob">EnqueueJob</a></emu-xref>(<code>"PromiseJobs"</code>, <emu-xref aoid="PromiseReactionJob"><a href="#sec-promisereactionjob">PromiseReactionJob</a></emu-xref>, « <var>fulfillReaction</var>, <var>value</var> »).</li></ol></li><li>Else,<ol><li>Assert: The value of <var>promise</var>.[[PromiseState]] is <code>"rejected"</code>.</li><li>Let <var>reason</var> be <var>promise</var>.[[PromiseResult]].</li><li>If <var>promise</var>.[[PromiseIsHandled]] is <emu-val>false</emu-val><ins> and <var>reason</var> does not have a [[CancelBrand]] internal slot</ins>, perform <emu-xref aoid="HostPromiseRejectionTracker"><a href="#sec-host-promise-rejection-tracker">HostPromiseRejectionTracker</a></emu-xref>(<var>promise</var>, <code>"handle"</code>).</li><li>Perform <emu-xref aoid="EnqueueJob"><a href="https://tc39.github.io/ecma262/#sec-enqueuejob">EnqueueJob</a></emu-xref>(<code>"PromiseJobs"</code>, <emu-xref aoid="PromiseReactionJob"><a href="#sec-promisereactionjob">PromiseReactionJob</a></emu-xref>, « <var>rejectReaction</var>, <var>reason</var> »).</li></ol></li><li>Set <var>promise</var>.[[PromiseIsHandled]] to <emu-val>true</emu-val>.</li><li>Return <var>resultCapability</var>.[[Promise]].
        </li></ol></emu-alg>
      </emu-clause>
    </emu-clause>
  </emu-clause>


<emu-clause id="sec-cancel-objects">
  <h1><span class="secnum">2</span><ins>Cancel Objects</ins><span class="utils"><span class="anchor"><a href="#sec-cancel-objects">#</a></span></span></h1>

  <p>Instances of Cancel objects are thrown as exceptions when an operations has been canceled. They do not indicate a runtime error, and are treated differently from other exceptions in several places in this specification.</p>

  <emu-clause id="sec-cancel-constructor">
    <h1><span class="secnum">2.1</span>The Cancel Constructor<span class="utils"><span class="anchor"><a href="#sec-cancel-constructor">#</a></span></span></h1>

    <p>The Cancel constructor is the  <dfn>%Cancel%</dfn> intrinsic object and the initial value of the <code>Cancel</code> property of the <emu-xref href="#global-object"><a href="https://tc39.github.io/ecma262/#global-object">global object</a></emu-xref>. When <code>Cancel</code> is called as a function rather than as a constructor, it creates and initializes a new Cancel object. Thus the function call <code>Cancel(…)</code> is equivalent to the object creation expression <code>new Cancel(…)</code> with the same arguments.</p>

    <p>The <code>Cancel</code> constructor is designed to be subclassable. It may be used as the value of an <code>extends</code> clause of a class definition. Subclass constructors that intend to inherit the specified <code>Cancel</code> behaviour must include a <code>super</code> call to the <code>Cancel</code> constructor to create and initialize subclass instances with a [[CancelBrand]] internal slot.</p>

    <emu-clause id="sec-cancel-message">
      <h1><span class="secnum">2.1.1</span>Cancel ( <var>message</var> )<span class="utils"><span class="anchor"><a href="#sec-cancel-message">#</a></span></span></h1>

      <p>When the <code>Cancel</code> function is called with argument <var>message</var>, the following steps are taken:</p>

      <emu-alg><ol><li>If NewTarget is <emu-val>undefined</emu-val>, let <var>newTarget</var> be the <emu-xref href="#active-function-object"><a href="https://tc39.github.io/ecma262/#active-function-object">active function object</a></emu-xref>, else let <var>newTarget</var> be NewTarget.</li><li>Let <var>O</var> be ? <emu-xref aoid="OrdinaryCreateFromConstructor"><a href="https://tc39.github.io/ecma262/#sec-ordinarycreatefromconstructor">OrdinaryCreateFromConstructor</a></emu-xref>(<var>newTarget</var>, <code>"%CancelPrototype%"</code>, « [[CancelBrand]] »).</li><li>If <var>message</var> is not <emu-val>undefined</emu-val>, then<ol><li>Let <var>msg</var> be ? <emu-xref aoid="ToString"><a href="https://tc39.github.io/ecma262/#sec-tostring">ToString</a></emu-xref>(<var>message</var>).</li><li>Let <var>msgDesc</var> be the PropertyDescriptor { [[Value]]: <var>msg</var>, [[Writable]]: <emu-val>true</emu-val>, [[Enumerable]]: <emu-val>false</emu-val>, [[Configurable]]: <emu-val>true</emu-val> }.</li><li>Perform ! <emu-xref aoid="DefinePropertyOrThrow"><a href="https://tc39.github.io/ecma262/#sec-definepropertyorthrow">DefinePropertyOrThrow</a></emu-xref>(<var>O</var>, <code>"message"</code>, <var>msgDesc</var>).</li></ol></li><li>Return <var>O</var>.
      </li></ol></emu-alg>
    </emu-clause>
  </emu-clause>

  <emu-clause id="sec-properties-of-the-cancel-constructor">
    <h1><span class="secnum">2.2</span>Properties of the Cancel Constructor<span class="utils"><span class="anchor"><a href="#sec-properties-of-the-cancel-constructor">#</a></span></span></h1>

    <p>The value of the [[Prototype]] internal slot of the Cancel constructor is the intrinsic object <emu-xref href="#sec-properties-of-the-function-constructor"><a href="https://tc39.github.io/ecma262/#sec-properties-of-the-function-constructor">%FunctionPrototype%</a></emu-xref>.</p>

    <p>The Cancel constructor has the following properties:</p>

    <emu-clause id="sec-cancel.prototype">
      <h1><span class="secnum">2.2.1</span>Cancel.prototype<span class="utils"><span class="anchor"><a href="#sec-cancel.prototype">#</a></span></span></h1>
      <p>The initial value of <code>Cancel.prototype</code> is the intrinsic object <emu-xref href="#sec-properties-of-the-cancel-prototype-object"><a href="#sec-properties-of-the-cancel-prototype-object">%CancelPrototype%</a></emu-xref>.</p>
      <p>This property has the attributes { [[Writable]]: <emu-val>false</emu-val>, [[Enumerable]]: <emu-val>false</emu-val>, [[Configurable]]: <emu-val>false</emu-val> }.</p>
    </emu-clause>
  </emu-clause>

  <emu-clause id="sec-properties-of-the-cancel-prototype-object">
    <h1><span class="secnum">2.3</span>Properties of the Cancel Prototype Object<span class="utils"><span class="anchor"><a href="#sec-properties-of-the-cancel-prototype-object">#</a></span></span></h1>

    <p>The Cancel prototype object is the intrinsic object  <dfn>%CancelPrototype%</dfn>. The Cancel prototype object is an ordinary object. It is not a Cancel instance and does not have a [[CancelBrand]] internal slot.</p>

    <p>The value of the [[Prototype]] internal slot of the Cancel prototype object is the intrinsic object <emu-xref href="#sec-properties-of-the-object-prototype-object"><a href="https://tc39.github.io/ecma262/#sec-properties-of-the-object-prototype-object">%ObjectPrototype%</a></emu-xref>.</p>

    <emu-clause id="sec-cancel.prototype.constructor">
      <h1><span class="secnum">2.3.1</span>Cancel.prototype.constructor<span class="utils"><span class="anchor"><a href="#sec-cancel.prototype.constructor">#</a></span></span></h1>
      <p>The initial value of <code>Cancel.prototype.constructor</code> is the intrinsic object <emu-xref href="#sec-cancel-constructor"><a href="#sec-cancel-constructor">%Cancel%</a></emu-xref>.</p>
    </emu-clause>

    <emu-clause id="sec-cancel.prototype.tostring">
      <h1><span class="secnum">2.3.2</span>Cancel.prototype.toString ( )<span class="utils"><span class="anchor"><a href="#sec-cancel.prototype.tostring">#</a></span></span></h1>
      <p>The following steps are taken:</p>
      <emu-alg><ol><li>Let <var>O</var> be the <emu-val>this</emu-val> value.</li><li>If <emu-xref aoid="Type"><a href="https://tc39.github.io/ecma262/#sec-ecmascript-data-types-and-values">Type</a></emu-xref>(<var>O</var>) is not Object, throw a <emu-val>TypeError</emu-val> exception.</li><li>Let <var>msg</var> be ? <emu-xref aoid="Get"><a href="https://tc39.github.io/ecma262/#sec-get-o-p">Get</a></emu-xref>(<var>O</var>, <code>"message"</code>).</li><li>If <var>msg</var> is <emu-val>undefined</emu-val>, let <var>msg</var> be the empty String; otherwise let <var>msg</var> be ? <emu-xref aoid="ToString"><a href="https://tc39.github.io/ecma262/#sec-tostring">ToString</a></emu-xref>(<var>msg</var>).</li><li>If <var>msg</var> is the empty String, return <code>"Cancel"</code>.</li><li>Return the result of concatenating <code>"Cancel: "</code> and <var>msg</var>.
      </li></ol></emu-alg>
    </emu-clause>
  </emu-clause>

  <emu-clause id="sec-properties-of-cancel-instances">
    <h1><span class="secnum">2.4</span>Properties of Cancel Instances<span class="utils"><span class="anchor"><a href="#sec-properties-of-cancel-instances">#</a></span></span></h1>
    <p>Cancel instances are ordinary objects that inherit properties from the Cancel prototype object and have a [[CancelBrand]] internal slot whose value is <emu-val>undefined</emu-val>. The only use of [[CancelBrand]] is to identify Cancel instances; its actual value is not important and it does not store any data.</p>
  </emu-clause>
</emu-clause>

<emu-clause id="sec-canceltoken-objects">
  <h1><span class="secnum">3</span><ins>CancelToken Objects</ins><span class="utils"><span class="anchor"><a href="#sec-canceltoken-objects">#</a></span></span></h1>

  <p>A cancel token is an object that allows its consumer to monitor and respond to requests for cancelation of an ongoing operation.</p>

  <emu-clause id="sec-canceltoken-constructor">
    <h1><span class="secnum">3.1</span>The CancelToken Constructor<span class="utils"><span class="anchor"><a href="#sec-canceltoken-constructor">#</a></span></span></h1>

    <p>The CancelToken constructor is the  <dfn>%CancelToken%</dfn> intrinsic object and the initial value of the <code>CancelToken</code> property of the <emu-xref href="#global-object"><a href="https://tc39.github.io/ecma262/#global-object">global object</a></emu-xref>. When called as a constructor, it creates and initializes as a new CancelToken object. <code>CancelToken</code> is not intended to be called as a function and will throw an exception when called in that manner.</p>

    <p>The <code>CancelToken</code> constructor is designed to be subclassable. It may be used as the value in an <code>extends</code> clause of a class definition. Subclass constructors that intend to inherit the specified <code>CancelToken</code> behaviour must include a <code>super</code> call to the <code>CancelToken</code> constructor to create and initialize the subclass instance with the internal state necessary to support the <code>CancelToken</code> and <code>CancelToken.prototype</code> built-in methods.</p>

    <emu-clause id="sec-canceltoken-constructor-definition">
      <h1><span class="secnum">3.1.1</span>CancelToken ( <var>executor</var> )<span class="utils"><span class="anchor"><a href="#sec-canceltoken-constructor-definition">#</a></span></span></h1>

      <p>When the <code>CancelToken</code> function is called with argument <var>executor</var>, the following steps are taken:</p>

      <emu-alg><ol><li>If NewTarget is <emu-val>undefined</emu-val>, throw a <emu-val>TypeError</emu-val> exception.</li><li>If <emu-xref aoid="IsCallable"><a href="https://tc39.github.io/ecma262/#sec-iscallable">IsCallable</a></emu-xref>(<var>executor</var>) is <emu-val>false</emu-val>, throw a <emu-val>TypeError</emu-val> exception.</li><li>Let <var>cancelToken</var> be ? <emu-xref aoid="OrdinaryCreateFromConstructor"><a href="https://tc39.github.io/ecma262/#sec-ordinarycreatefromconstructor">OrdinaryCreateFromConstructor</a></emu-xref>(NewTarget, <code>"%CancelTokenPrototype"</code>, « [[CancelTokenPromise]] »).</li><li>Let <var>dummyExecutor</var> be an anonymous built-in function of no arguments that does nothing besides return <emu-val>undefined</emu-val>.</li><li>Let <var>promise</var> be ! <emu-xref aoid="Construct"><a href="https://tc39.github.io/ecma262/#sec-construct">Construct</a></emu-xref>(<emu-xref href="#sec-promise-constructor"><a href="https://tc39.github.io/ecma262/#sec-promise-constructor">%Promise%</a></emu-xref>, « <var>executor</var> »).</li><li>Set <var>cancelToken</var>.[[CancelTokenPromise]] to <var>promise</var>.</li><li>Let <var>cancel</var> be a new built-in function object as defined in <emu-xref href="#sec-canceler-functions" title=""><a href="#sec-canceler-functions">Canceler Functions</a></emu-xref>.</li><li>Set <var>cancel</var>.[[Promise]] to <var>promise</var>.</li><li>Perform ? <emu-xref aoid="Call"><a href="https://tc39.github.io/ecma262/#sec-call">Call</a></emu-xref>(<var>executor</var>, <emu-val>undefined</emu-val>, « <var>cancel</var> »).</li><li>Return <var>cancelToken</var>.
      </li></ol></emu-alg>

      <emu-note><span class="note">Note</span>
        <p>The <var>executor</var> argument must be a function object. It is called to vend the ability to send the cancelation token into a canceled state, via its single argument, <var>cancel</var>.</p>
        <p>The <var>cancel</var> function that is passed to an <var>executor</var> function accepts a single argument. The <var>executor</var> code may eventually call the <var>cancel</var> function indicate it wishes to request cancelation. The argument passed to the <var>cancel</var> function represents the cancelation. If it is not a "thenable" value, cancelation will be requested immediately; otherwise, cancelation will be requested once the passed thenable fulfills.</p>
      </emu-note>

      <emu-clause id="sec-canceler-functions">
        <h1><span class="secnum">3.1.1.1</span>Canceler Functions<span class="utils"><span class="anchor"><a href="#sec-canceler-functions">#</a></span></span></h1>

        <p>A Canceler function is an anonymous built-in function that has a [[Promise]] internal slot.</p>

        <p>When a Canceler function <var>F</var> is called with argument <var>cancelMessage</var>, the following steps are taken:</p>

        <emu-alg><ol><li>Assert: <var>F</var> has a [[Promise]] internal slot whose value is an instance of the intrinsic <emu-xref href="#sec-promise-constructor"><a href="https://tc39.github.io/ecma262/#sec-promise-constructor">%Promise%</a></emu-xref>.</li><li>Let <var>promise</var> be <var>F</var>.[[Promise]].</li><li>Let <var>cancelation</var> be ? <emu-xref aoid="Construct"><a href="https://tc39.github.io/ecma262/#sec-construct">Construct</a></emu-xref>(<emu-xref href="#sec-cancel-constructor"><a href="#sec-cancel-constructor">%Cancel%</a></emu-xref>, « <var>cancelMessage</var> »).</li><li>Return <emu-xref aoid="ResolvePromise"><a href="#sec-resolvepromise">ResolvePromise</a></emu-xref>(<var>promise</var>, <var>cancelation</var>).
        </li></ol></emu-alg>
      </emu-clause>
    </emu-clause>
  </emu-clause>

  <emu-clause id="sec-properties-of-the-canceltoken-constructor">
    <h1><span class="secnum">3.2</span>Properties of the CancelToken Constructor<span class="utils"><span class="anchor"><a href="#sec-properties-of-the-canceltoken-constructor">#</a></span></span></h1>

    <p>The value of the [[Prototype]] internal slot of the <code>CancelToken</code> constructor is the intrinsic object <emu-xref href="#sec-properties-of-the-canceltoken-prototype-object"><a href="#sec-properties-of-the-canceltoken-prototype-object">%CancelTokenPrototype%</a></emu-xref>.</p>

    <p>The CancelToken constructor has the following properties:</p>

    <emu-clause id="sec-canceltoken.source">
      <h1><span class="secnum">3.2.1</span>CancelToken.source()<span class="utils"><span class="anchor"><a href="#sec-canceltoken.source">#</a></span></span></h1>

      <p>The <code>source()</code> function returns an object with two properties, <code>token</code> and <code>cancel</code>, which respectively give a newly-created cancel token, and the ability to request cancelation for that token. It is a convenient alternative to the <code>CancelToken</code> constructor.</p>

      <emu-alg><ol><li>Let <var>C</var> be the <emu-val>this</emu-val> value.</li><li>If <emu-xref aoid="Type"><a href="https://tc39.github.io/ecma262/#sec-ecmascript-data-types-and-values">Type</a></emu-xref>(<var>C</var>) is not Object, throw a <emu-val>TypeError</emu-val> exception.</li><li>Let <var>cancelStorage</var> be a new <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref> { [[Value]]: <emu-val>undefined</emu-val> }.</li><li>Let <var>executor</var> be a new built-in function object as defined in <emu-xref href="#sec-getcancelexecutor-functions" title=""><a href="#sec-getcancelexecutor-functions">GetCancelExecutor Functions</a></emu-xref>.</li><li>Set <var>executor</var>.[[CancelStorage]] to <var>cancelStorage</var>.</li><li>Let <var>cancelToken</var> be ? <emu-xref aoid="Construct"><a href="https://tc39.github.io/ecma262/#sec-construct">Construct</a></emu-xref>(<var>C</var>, « <var>executor</var> »).</li><li>Let <var>result</var> be ! <emu-xref aoid="ObjectCreate"><a href="https://tc39.github.io/ecma262/#sec-objectcreate">ObjectCreate</a></emu-xref>(<emu-xref href="#sec-properties-of-the-object-prototype-object"><a href="https://tc39.github.io/ecma262/#sec-properties-of-the-object-prototype-object">%ObjectPrototype%</a></emu-xref>).</li><li>Perform ! <emu-xref aoid="CreateDataProperty"><a href="https://tc39.github.io/ecma262/#sec-createdataproperty">CreateDataProperty</a></emu-xref>(<var>result</var>, <code>"token"</code>, <var>cancelToken</var>).</li><li>Perform ! <emu-xref aoid="CreateDataProperty"><a href="https://tc39.github.io/ecma262/#sec-createdataproperty">CreateDataProperty</a></emu-xref>(<var>result</var>, <code>"cancel"</code>, <var>cancelStorage</var>.[[Value]]).</li><li>Return <var>result</var>.
      </li></ol></emu-alg>

      <emu-clause id="sec-getcancelexecutor-functions">
        <h1><span class="secnum">3.2.1.1</span>GetCancelExecutor Functions<span class="utils"><span class="anchor"><a href="#sec-getcancelexecutor-functions">#</a></span></span></h1>

        <p>A GetCancelExecutor function is an anonymous built-in function that has a [[CancelStorage]] internal slot.</p>

        <p>When a GetCancelExecutor function <var>F</var> is called with arguments <var>cancel</var>, the following steps are taken:</p>

        <emu-alg><ol><li>Assert: <var>F</var> has a [[CancelStorage]] internal slot whose value is a <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref> containing a single field [[Value]].</li><li>Let <var>cancelStorage</var> be <var>F</var>.[[CancelStorage]].</li><li>Set <var>cancelStorage</var>.[[Value]] to <var>cancel</var>.</li><li>Return <emu-val>undefined</emu-val>.
        </li></ol></emu-alg>

        <p>The <code>length</code> property of a GetCancelExecutor function is 1.</p>
      </emu-clause>
    </emu-clause>

    <emu-clause id="sec-canceltoken.prototype">
      <h1><span class="secnum">3.2.2</span>CancelToken.prototype<span class="utils"><span class="anchor"><a href="#sec-canceltoken.prototype">#</a></span></span></h1>

      <p>The initial value of <code>CancelToken.prototype</code> is the intrinsic object <emu-xref href="#sec-properties-of-the-canceltoken-prototype-object"><a href="#sec-properties-of-the-canceltoken-prototype-object">%CancelTokenPrototype%</a></emu-xref>.</p>

      <p>This property has the attributes { [[Writable]]: <emu-val>false</emu-val>, [[Enumerable]]: <emu-val>false</emu-val>, [[Configurable]]: <emu-val>false</emu-val> }.</p>
    </emu-clause>
  </emu-clause>

  <emu-clause id="sec-properties-of-the-canceltoken-prototype-object">
    <h1><span class="secnum">3.3</span>Properties of the CancelToken Prototype Object<span class="utils"><span class="anchor"><a href="#sec-properties-of-the-canceltoken-prototype-object">#</a></span></span></h1>

    <p>The CancelToken prototype object is the intrinsic object  <dfn>%CancelTokenPrototype%</dfn>. The value of the [[Prototype]] internal slot of the CancelToken prototype object is the intrinsic object <emu-xref href="#sec-properties-of-the-object-prototype-object"><a href="https://tc39.github.io/ecma262/#sec-properties-of-the-object-prototype-object">%ObjectPrototype%</a></emu-xref>. The CancelToken prototype object is an ordinary object. It does not have a [[CancelTokenPromise]] internal slot or any of the other internal slots of CancelToken instances.</p>

    <emu-clause id="sec-canceltoken.prototype.throwifrequested">
      <h1><span class="secnum">3.3.1</span>CancelToken.prototype.throwIfRequested ( )<span class="utils"><span class="anchor"><a href="#sec-canceltoken.prototype.throwifrequested">#</a></span></span></h1>

      <p>When the <code>throwIfRequested</code> method is called, the following steps are taken:</p>

      <emu-alg><ol><li>Let <var>T</var> be the <emu-val>this</emu-val> value.</li><li>If <emu-xref aoid="Type"><a href="https://tc39.github.io/ecma262/#sec-ecmascript-data-types-and-values">Type</a></emu-xref>(<var>T</var>) is not Object, throw a <emu-val>TypeError</emu-val> exception.</li><li>If <var>T</var> does not have a [[CancelTokenPromise]] internal slot, throw a <emu-val>TypeError</emu-val> exception.</li><li>Let <var>P</var> be <var>T</var>.[[CancelTokenPromise]].</li><li>If <var>P</var>.[[PromiseState]] is <code>"fulfilled"</code>, return <emu-xref aoid="Completion"><a href="https://tc39.github.io/ecma262/#sec-completion-record-specification-type">Completion</a></emu-xref> { [[Type]]: <emu-const>throw</emu-const>, [[Value]]: <var>P</var>.[[PromiseResult]], [[Target]]: <emu-const>empty</emu-const> }.</li><li>Return <emu-val>undefined</emu-val>.
      </li></ol></emu-alg>
    </emu-clause>

    <emu-clause id="sec-canceltoken.prototype.constructor">
      <h1><span class="secnum">3.3.2</span>CancelToken.prototype.constructor<span class="utils"><span class="anchor"><a href="#sec-canceltoken.prototype.constructor">#</a></span></span></h1>

      <p>The initial value of <code>CancelToken.prototype.constructor</code> is the intrinsic object <emu-xref href="#sec-canceltoken-constructor"><a href="#sec-canceltoken-constructor">%CancelToken%</a></emu-xref>.</p>
    </emu-clause>

    <emu-clause id="sec-canceltoken.prototype.promise">
      <h1><span class="secnum">3.3.3</span>get CancelToken.prototype.promise<span class="utils"><span class="anchor"><a href="#sec-canceltoken.prototype.promise">#</a></span></span></h1>

      <p><code>CancelToken.prototype.promise</code> is an accessor property whose set accessor is <emu-val>undefined</emu-val>. Its get accessor function performs the following steps:</p>

      <emu-alg><ol><li>Let <var>T</var> be the <emu-val>this</emu-val> value.</li><li>If <emu-xref aoid="Type"><a href="https://tc39.github.io/ecma262/#sec-ecmascript-data-types-and-values">Type</a></emu-xref>(<var>T</var>) is not Object, throw a <emu-val>TypeError</emu-val> exception.</li><li>If <var>T</var> does not have a [[CancelTokenPromise]] internal slot, throw a <emu-val>TypeError</emu-val> exception.</li><li>Return <var>T</var>.[[CancelTokenPromise]].
      </li></ol></emu-alg>
    </emu-clause>

    <emu-clause id="sec-canceltoken.prototype.requested">
      <h1><span class="secnum">3.3.4</span>get CancelToken.prototype.requested<span class="utils"><span class="anchor"><a href="#sec-canceltoken.prototype.requested">#</a></span></span></h1>

      <p><code>CancelToken.prototype.requested</code> is an accessor property whose set accessor is <emu-val>undefined</emu-val>. Its get accessor function performs the following steps:</p>

      <emu-alg><ol><li>Let <var>T</var> be the <emu-val>this</emu-val> value.</li><li>If <emu-xref aoid="Type"><a href="https://tc39.github.io/ecma262/#sec-ecmascript-data-types-and-values">Type</a></emu-xref>(<var>T</var>) is not Object, throw a <emu-val>TypeError</emu-val> exception.</li><li>If <var>T</var> does not have a [[CancelTokenPromise]] internal slot, throw a <emu-val>TypeError</emu-val> exception.</li><li>If <var>T</var>.[[CancelTokenPromise]].[[PromiseState]] is <code>"fulfilled"</code>, return <emu-val>true</emu-val>.</li><li>Return <emu-val>false</emu-val>.
      </li></ol></emu-alg>
    </emu-clause>

    <emu-clause id="sec-canceltoken.prototype-@@tostringtag">
      <h1><span class="secnum">3.3.5</span>CancelToken.prototype [ @@toStringTag ]<span class="utils"><span class="anchor"><a href="#sec-canceltoken.prototype-@@tostringtag">#</a></span></span></h1>
      <p>The initial value of the @@toStringTag property is the String value <code>"CancelToken"</code>.</p>
      <p>This property has the attributes { [[Writable]]: <emu-val>false</emu-val>, [[Enumerable]]: <emu-val>false</emu-val>, [[Configurable]]: <emu-val>true</emu-val> }.</p>
    </emu-clause>
  </emu-clause>

  <emu-clause id="sec-properties-of-canceltoken-instances">
    <h1><span class="secnum">3.4</span>Properties of CancelToken Instances<span class="utils"><span class="anchor"><a href="#sec-properties-of-canceltoken-instances">#</a></span></span></h1>

    <p>CancelToken instances are ordinary objects that inherit properties from the CancelToken prototype object (the intrinsic, <emu-xref href="#sec-properties-of-the-canceltoken-prototype-object"><a href="#sec-properties-of-the-canceltoken-prototype-object">%CancelTokenPrototype%</a></emu-xref>). CancelToken instances are initially created with the internal slots described in  <emu-xref href="#table-canceltoken-internal-slots"><a href="#table-canceltoken-internal-slots">Table 2</a></emu-xref>.</p>

    <emu-table id="table-canceltoken-internal-slots" caption="Internal Slots of CancelToken Instances"><figure><figcaption>Table 2: Internal Slots of CancelToken Instances</figcaption>
      <table>
        <thead>
          <tr>
            <th>Internal Slot</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>[[CancelTokenPromise]]</td>
            <td>A Promise object (always an instance of the intrinsic, <emu-xref href="#sec-promise-constructor"><a href="https://tc39.github.io/ecma262/#sec-promise-constructor">%Promise%</a></emu-xref>) which will be fulfilled when/if cancelation is requested.
          
          </td></tr>
        </tbody>
      </table>
    </figure></emu-table>
  </emu-clause>
</emu-clause>

<emu-clause id="sec-ecmascript-language-statements-and-declarations">
  <h1><span class="secnum">4</span>ECMAScript Language: Statements and Declarations<span class="utils"><span class="anchor"><a href="#sec-ecmascript-language-statements-and-declarations">#</a></span></span></h1>

  <emu-note><span class="note">Note</span>
    <p>Spec reviewer note: inserted productions are not being highlighted in green due to  <a href="https://github.com/bterlson/ecmarkup/issues/95">an Ecmarkup bug</a>, despite the source file markup them up as inserted. We apologize for the inconvenience.</p>
  </emu-note>

  <emu-clause id="sec-try-statement">
    <h1><span class="secnum">4.1</span>The <code>try</code> Statement<span class="utils"><span class="anchor"><a href="#sec-try-statement">#</a></span></span></h1>
    <h2>Syntax</h2>
    <emu-grammar><emu-production name="TryStatement" params="Yield, Return" id="prod-TryStatement">
    <emu-nt params="Yield, Return"><a href="#prod-TryStatement">TryStatement</a><emu-mods><emu-params>[Yield, Return]</emu-params></emu-mods></emu-nt><emu-geq>:</emu-geq><emu-rhs a="624913c6"><emu-t>try</emu-t><emu-nt params="?Yield, ?Return"><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a><emu-mods><emu-params>[?Yield, ?Return]</emu-params></emu-mods></emu-nt><emu-nt params="?Yield, ?Return"><a href="#prod-Catch">Catch</a><emu-mods><emu-params>[?Yield, ?Return]</emu-params></emu-mods></emu-nt></emu-rhs><ins>
    <emu-rhs a="aeb66e31"><emu-t>try</emu-t><emu-nt params="?Yield, ?Return"><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a><emu-mods><emu-params>[?Yield, ?Return]</emu-params></emu-mods></emu-nt><emu-nt params="?Yield, ?Return"><a href="#prod-Else">Else</a><emu-mods><emu-params>[?Yield, ?Return]</emu-params></emu-mods></emu-nt></emu-rhs></ins>
    <emu-rhs a="4d12a36d"><emu-t>try</emu-t><emu-nt params="?Yield, ?Return"><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a><emu-mods><emu-params>[?Yield, ?Return]</emu-params></emu-mods></emu-nt><emu-nt params="?Yield, ?Return"><a href="#prod-Finally">Finally</a><emu-mods><emu-params>[?Yield, ?Return]</emu-params></emu-mods></emu-nt></emu-rhs>
    <emu-rhs a="0e4cced4"><emu-t>try</emu-t><emu-nt params="?Yield, ?Return"><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a><emu-mods><emu-params>[?Yield, ?Return]</emu-params></emu-mods></emu-nt><emu-nt params="?Yield, ?Return"><a href="#prod-Catch">Catch</a><emu-mods><emu-params>[?Yield, ?Return]</emu-params></emu-mods></emu-nt><emu-nt params="?Yield, ?Return"><a href="#prod-Finally">Finally</a><emu-mods><emu-params>[?Yield, ?Return]</emu-params></emu-mods></emu-nt></emu-rhs><ins>
    <emu-rhs a="3f15b6d4"><emu-t>try</emu-t><emu-nt params="?Yield, ?Return"><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a><emu-mods><emu-params>[?Yield, ?Return]</emu-params></emu-mods></emu-nt><emu-nt params="?Yield, ?Return"><a href="#prod-Else">Else</a><emu-mods><emu-params>[?Yield, ?Return]</emu-params></emu-mods></emu-nt><emu-nt params="?Yield, ?Return"><a href="#prod-Finally">Finally</a><emu-mods><emu-params>[?Yield, ?Return]</emu-params></emu-mods></emu-nt></emu-rhs>
</ins></emu-production>
<emu-production name="Catch" params="Yield, Return" id="prod-Catch">
    <emu-nt params="Yield, Return"><a href="#prod-Catch">Catch</a><emu-mods><emu-params>[Yield, Return]</emu-params></emu-mods></emu-nt><emu-geq>:</emu-geq><emu-rhs a="626e3734"><emu-t>catch</emu-t><emu-t>(</emu-t><emu-nt params="?Yield"><a href="#prod-CatchParameter">CatchParameter</a><emu-mods><emu-params>[?Yield]</emu-params></emu-mods></emu-nt><emu-t>)</emu-t><emu-nt params="?Yield, ?Return"><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a><emu-mods><emu-params>[?Yield, ?Return]</emu-params></emu-mods></emu-nt></emu-rhs>
</emu-production><ins>
<emu-production name="Else" params="Yield, Return" id="prod-Else">
    <emu-nt params="Yield, Return"><a href="#prod-Else">Else</a><emu-mods><emu-params>[Yield, Return]</emu-params></emu-mods></emu-nt><emu-geq>:</emu-geq><emu-rhs a="ad58ea14"><emu-t>else</emu-t><emu-t>(</emu-t><emu-nt params="?Yield"><a href="#prod-CatchParameter">CatchParameter</a><emu-mods><emu-params>[?Yield]</emu-params></emu-mods></emu-nt><emu-t>)</emu-t><emu-nt params="?Yield, ?Return"><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a><emu-mods><emu-params>[?Yield, ?Return]</emu-params></emu-mods></emu-nt></emu-rhs>
</emu-production></ins>
<emu-production name="Finally" params="Yield, Return" id="prod-Finally">
    <emu-nt params="Yield, Return"><a href="#prod-Finally">Finally</a><emu-mods><emu-params>[Yield, Return]</emu-params></emu-mods></emu-nt><emu-geq>:</emu-geq><emu-rhs a="a8da6c41"><emu-t>finally</emu-t><emu-nt params="?Yield, ?Return"><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a><emu-mods><emu-params>[?Yield, ?Return]</emu-params></emu-mods></emu-nt></emu-rhs>
</emu-production>
<emu-production name="CatchParameter" params="Yield" id="prod-CatchParameter">
    <emu-nt params="Yield"><a href="#prod-CatchParameter">CatchParameter</a><emu-mods><emu-params>[Yield]</emu-params></emu-mods></emu-nt><emu-geq>:</emu-geq><emu-rhs a="46cd8f8d"><emu-nt params="?Yield"><a href="https://tc39.github.io/ecma262/#prod-BindingIdentifier">BindingIdentifier</a><emu-mods><emu-params>[?Yield]</emu-params></emu-mods></emu-nt></emu-rhs>
    <emu-rhs a="7a565a71"><emu-nt params="?Yield"><a href="https://tc39.github.io/ecma262/#prod-BindingPattern">BindingPattern</a><emu-mods><emu-params>[?Yield]</emu-params></emu-mods></emu-nt></emu-rhs>
</emu-production></emu-grammar>
    <emu-note><span class="note">Note</span>
      <p>The <code>try</code> statement encloses a block of code in which an exceptional condition can occur, such as a runtime error or a <code>throw</code> statement. The <code>catch</code> clause provides the exception-handling code. When a <code>catch</code> clause catches an exception, its <emu-nt><a href="#prod-CatchParameter">CatchParameter</a></emu-nt> is bound to that exception.  <ins>The <code>else</code> clause provides error-handling code. It behaves identically to a <code>catch</code> clause, except that it does not catch cancelations (i.e. <code>Cancel</code> objects).</ins></p>
    </emu-note>

    <!-- es6num="13.15.1" -->
    <emu-clause id="sec-try-statement-static-semantics-early-errors">
      <h1><span class="secnum">4.1.1</span>Static Semantics: Early Errors<span class="utils"><span class="anchor"><a href="#sec-try-statement-static-semantics-early-errors">#</a></span></span></h1>
      <emu-grammar><emu-production name="Catch" collapsed="">
    <emu-nt><a href="#prod-Catch">Catch</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="ddc13c36"><emu-t>catch</emu-t><emu-t>(</emu-t><emu-nt><a href="#prod-CatchParameter">CatchParameter</a></emu-nt><emu-t>)</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt></emu-rhs>
</emu-production></emu-grammar>
      <ul>
        <li>
          It is a Syntax Error if BoundNames of <emu-nt><a href="#prod-CatchParameter">CatchParameter</a></emu-nt> contains any duplicate elements.
        
        </li>
        <li>
          It is a Syntax Error if any element of the BoundNames of <emu-nt><a href="#prod-CatchParameter">CatchParameter</a></emu-nt> also occurs in the LexicallyDeclaredNames of <emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt>.
        
        </li>
        <li>
          It is a Syntax Error if any element of the BoundNames of <emu-nt><a href="#prod-CatchParameter">CatchParameter</a></emu-nt> also occurs in the VarDeclaredNames of <emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt>.
        
        </li>
      </ul>
      <emu-note><span class="note">Note 1</span>
        <p>An alternative static semantics for this production is given in  <emu-xref href="#sec-variablestatements-in-catch-blocks"><a href="https://tc39.github.io/ecma262/#sec-variablestatements-in-catch-blocks">B.3.5</a></emu-xref>.</p>
      </emu-note>

      <ins><emu-grammar><emu-production name="Else" collapsed="">
    <emu-nt><a href="#prod-Else">Else</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="fb38ddb5"><emu-t>else</emu-t><emu-t>(</emu-t><emu-nt><a href="#prod-CatchParameter">CatchParameter</a></emu-nt><emu-t>)</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt></emu-rhs>
</emu-production></emu-grammar></ins>
      <ul>
        <li>
          <ins>It is a Syntax Error if BoundNames of <emu-nt><a href="#prod-CatchParameter">CatchParameter</a></emu-nt> contains any duplicate elements.</ins>
        </li>
        <li>
          <ins>It is a Syntax Error if any element of the BoundNames of <emu-nt><a href="#prod-CatchParameter">CatchParameter</a></emu-nt> also occurs in the LexicallyDeclaredNames of <emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt>.</ins>
        </li>
        <li>
          <ins>It is a Syntax Error if any element of the BoundNames of <emu-nt><a href="#prod-CatchParameter">CatchParameter</a></emu-nt> also occurs in the VarDeclaredNames of <emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt>.</ins>
        </li>
      </ul>

      <emu-note><span class="note">Note 2</span>
        <p><ins>The alternative static semantics for <code>catch</code> do not apply to <code>else</code>.</ins></p>
      </emu-note>
    </emu-clause>

    <!-- es6num="13.15.2" -->
    <emu-clause id="sec-try-statement-static-semantics-containsduplicatelabels">
      <h1><span class="secnum">4.1.2</span>Static Semantics: ContainsDuplicateLabels<span class="utils"><span class="anchor"><a href="#sec-try-statement-static-semantics-containsduplicatelabels">#</a></span></span></h1>
      <p>With argument <var>labelSet</var>.</p>
      <emu-see-also-para op="ContainsDuplicateLabels"></emu-see-also-para>

      <emu-grammar><emu-production name="TryStatement" collapsed="">
    <emu-nt><a href="#prod-TryStatement">TryStatement</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="a8714e57"><emu-t>try</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt><emu-nt><a href="#prod-Catch">Catch</a></emu-nt></emu-rhs>
</emu-production></emu-grammar>
      <emu-alg><ol><li>Let <var>hasDuplicates</var> be ContainsDuplicateLabels of <emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt> with argument <var>labelSet</var>.</li><li>If <var>hasDuplicates</var> is <emu-val>true</emu-val>, return <emu-val>true</emu-val>.</li><li>Return ContainsDuplicateLabels of <emu-nt><a href="#prod-Catch">Catch</a></emu-nt> with argument <var>labelSet</var>.
      </li></ol></emu-alg>

      <ins><emu-grammar><emu-production name="TryStatement" collapsed="">
    <emu-nt><a href="#prod-TryStatement">TryStatement</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="f71a1290"><emu-t>try</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt><emu-nt><a href="#prod-Else">Else</a></emu-nt></emu-rhs>
</emu-production></emu-grammar></ins>
      <emu-alg><ol><li><ins>Let <var>hasDuplicates</var> be ContainsDuplicateLabels of <emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt> with argument <var>labelSet</var>.</ins></li><li><ins>If <var>hasDuplicates</var> is <emu-val>true</emu-val>, return <emu-val>true</emu-val>.</ins></li><li><ins>Return ContainsDuplicateLabels of <emu-nt><a href="#prod-Else">Else</a></emu-nt> with argument <var>labelSet</var>.</ins>
      </li></ol></emu-alg>

      <emu-grammar><emu-production name="TryStatement" collapsed="">
    <emu-nt><a href="#prod-TryStatement">TryStatement</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="5ec68ab9"><emu-t>try</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt><emu-nt><a href="#prod-Finally">Finally</a></emu-nt></emu-rhs>
</emu-production></emu-grammar>
      <emu-alg><ol><li>Let <var>hasDuplicates</var> be ContainsDuplicateLabels of <emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt> with argument <var>labelSet</var>.</li><li>If <var>hasDuplicates</var> is <emu-val>true</emu-val>, return <emu-val>true</emu-val>.</li><li>Return ContainsDuplicateLabels of <emu-nt><a href="#prod-Finally">Finally</a></emu-nt> with argument <var>labelSet</var>.
      </li></ol></emu-alg>

      <emu-grammar><emu-production name="TryStatement" collapsed="">
    <emu-nt><a href="#prod-TryStatement">TryStatement</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="1b19737c"><emu-t>try</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt><emu-nt><a href="#prod-Catch">Catch</a></emu-nt><emu-nt><a href="#prod-Finally">Finally</a></emu-nt></emu-rhs>
</emu-production></emu-grammar>
      <emu-alg><ol><li>Let <var>hasDuplicates</var> be ContainsDuplicateLabels of <emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt> with argument <var>labelSet</var>.</li><li>If <var>hasDuplicates</var> is <emu-val>true</emu-val>, return <emu-val>true</emu-val>.</li><li>Let <var>hasDuplicates</var> be ContainsDuplicateLabels of <emu-nt><a href="#prod-Catch">Catch</a></emu-nt> with argument <var>labelSet</var>.</li><li>If <var>hasDuplicates</var> is <emu-val>true</emu-val>, return <emu-val>true</emu-val>.</li><li>Return ContainsDuplicateLabels of <emu-nt><a href="#prod-Finally">Finally</a></emu-nt> with argument <var>labelSet</var>.
      </li></ol></emu-alg>

      <emu-grammar><ins><emu-production name="TryStatement" collapsed="">
    <emu-nt><a href="#prod-TryStatement">TryStatement</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="033c80ab"><emu-t>try</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt><emu-nt><a href="#prod-Else">Else</a></emu-nt><emu-nt><a href="#prod-Finally">Finally</a></emu-nt></emu-rhs>
</emu-production></ins></emu-grammar>
      <emu-alg><ol><li><ins>Let <var>hasDuplicates</var> be ContainsDuplicateLabels of <emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt> with argument <var>labelSet</var>.</ins></li><li><ins>If <var>hasDuplicates</var> is <emu-val>true</emu-val>, return <emu-val>true</emu-val>.</ins></li><li><ins>Let <var>hasDuplicates</var> be ContainsDuplicateLabels of <emu-nt><a href="#prod-Else">Else</a></emu-nt> with argument <var>labelSet</var>.</ins></li><li><ins>If <var>hasDuplicates</var> is <emu-val>true</emu-val>, return <emu-val>true</emu-val>.</ins></li><li><ins>Return ContainsDuplicateLabels of <emu-nt><a href="#prod-Finally">Finally</a></emu-nt> with argument <var>labelSet</var>.</ins>
      </li></ol></emu-alg>

      <emu-grammar><emu-production name="Catch" collapsed="">
    <emu-nt><a href="#prod-Catch">Catch</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="ddc13c36"><emu-t>catch</emu-t><emu-t>(</emu-t><emu-nt><a href="#prod-CatchParameter">CatchParameter</a></emu-nt><emu-t>)</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt></emu-rhs>
</emu-production></emu-grammar>
      <emu-alg><ol><li>Return ContainsDuplicateLabels of <emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt> with argument <var>labelSet</var>.
      </li></ol></emu-alg>

      <emu-grammar><ins><emu-production name="Else" collapsed="">
    <emu-nt><a href="#prod-Else">Else</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="fb38ddb5"><emu-t>else</emu-t><emu-t>(</emu-t><emu-nt><a href="#prod-CatchParameter">CatchParameter</a></emu-nt><emu-t>)</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt></emu-rhs>
</emu-production></ins></emu-grammar>
      <emu-alg><ol><li><ins>Return ContainsDuplicateLabels of <emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt> with argument <var>labelSet</var>.</ins>
      </li></ol></emu-alg>
    </emu-clause>

    <!-- es6num="13.15.3" -->
    <emu-clause id="sec-try-statement-static-semantics-containsundefinedbreaktarget">
      <h1><span class="secnum">4.1.3</span>Static Semantics: ContainsUndefinedBreakTarget<span class="utils"><span class="anchor"><a href="#sec-try-statement-static-semantics-containsundefinedbreaktarget">#</a></span></span></h1>

      <p><ins>Modifications are analogous to those for ContainsDuplicateLabels.</ins></p>
    </emu-clause>

    <!-- es6num="13.15.4" -->
    <emu-clause id="sec-try-statement-static-semantics-containsundefinedcontinuetarget">
      <h1><span class="secnum">4.1.4</span>Static Semantics: ContainsUndefinedContinueTarget<span class="utils"><span class="anchor"><a href="#sec-try-statement-static-semantics-containsundefinedcontinuetarget">#</a></span></span></h1>

      <p><ins>Modifications are analogous to those for ContainsDuplicateLabels.</ins></p>
    </emu-clause>

    <!-- es6num="13.15.5" -->
    <emu-clause id="sec-try-statement-static-semantics-vardeclarednames">
      <h1><span class="secnum">4.1.5</span>Static Semantics: VarDeclaredNames<span class="utils"><span class="anchor"><a href="#sec-try-statement-static-semantics-vardeclarednames">#</a></span></span></h1>

      <p><ins>Modifications are analogous to those for ContainsDuplicateLabels.</ins></p>
    </emu-clause>

    <!-- es6num="13.15.6" -->
    <emu-clause id="sec-try-statement-static-semantics-varscopeddeclarations">
      <h1><span class="secnum">4.1.6</span>Static Semantics: VarScopedDeclarations<span class="utils"><span class="anchor"><a href="#sec-try-statement-static-semantics-varscopeddeclarations">#</a></span></span></h1>

      <p><ins>Modifications are analogous to those for ContainsDuplicateLabels.</ins></p>
    </emu-clause>

    <!-- es6num="13.15.7" -->
    <emu-clause id="sec-runtime-semantics-catchclauseevaluation">
      <h1><span class="secnum">4.1.7</span>Runtime Semantics: CatchClauseEvaluation<span class="utils"><span class="anchor"><a href="#sec-runtime-semantics-catchclauseevaluation">#</a></span></span></h1>
      <p>with parameter <var>thrownValue</var></p>
      <emu-grammar><emu-production name="Catch" collapsed="">
    <emu-nt><a href="#prod-Catch">Catch</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="ddc13c36"><emu-t>catch</emu-t><emu-t>(</emu-t><emu-nt><a href="#prod-CatchParameter">CatchParameter</a></emu-nt><emu-t>)</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt></emu-rhs>
</emu-production></emu-grammar>
      <emu-grammar><ins><emu-production name="Else" collapsed="">
    <emu-nt><a href="#prod-Else">Else</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="fb38ddb5"><emu-t>else</emu-t><emu-t>(</emu-t><emu-nt><a href="#prod-CatchParameter">CatchParameter</a></emu-nt><emu-t>)</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt></emu-rhs>
</emu-production></ins></emu-grammar>
      <emu-alg><ol><li>Let <var>oldEnv</var> be the <emu-xref href="#running-execution-context"><a href="https://tc39.github.io/ecma262/#running-execution-context">running execution context</a></emu-xref>'s LexicalEnvironment.</li><li>Let <var>catchEnv</var> be <emu-xref aoid="NewDeclarativeEnvironment"><a href="https://tc39.github.io/ecma262/#sec-newdeclarativeenvironment">NewDeclarativeEnvironment</a></emu-xref>(<var>oldEnv</var>).</li><li>Let <var>catchEnvRec</var> be <var>catchEnv</var>'s <emu-xref href="#sec-lexical-environments"><a href="https://tc39.github.io/ecma262/#sec-lexical-environments">EnvironmentRecord</a></emu-xref>.</li><li>For each element <var>argName</var> of the BoundNames of <emu-nt><a href="#prod-CatchParameter">CatchParameter</a></emu-nt>, do<ol><li>Perform ! <var>catchEnvRec</var>.CreateMutableBinding(<var>argName</var>, <emu-val>false</emu-val>).</li></ol></li><li>Set the <emu-xref href="#running-execution-context"><a href="https://tc39.github.io/ecma262/#running-execution-context">running execution context</a></emu-xref>'s LexicalEnvironment to <var>catchEnv</var>.</li><li>Let <var>status</var> be the result of performing BindingInitialization for <emu-nt><a href="#prod-CatchParameter">CatchParameter</a></emu-nt> passing <var>thrownValue</var> and <var>catchEnv</var> as arguments.</li><li>If <var>status</var> is an <emu-xref href="#sec-completion-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-completion-record-specification-type">abrupt completion</a></emu-xref>, then<ol><li>Set the <emu-xref href="#running-execution-context"><a href="https://tc39.github.io/ecma262/#running-execution-context">running execution context</a></emu-xref>'s LexicalEnvironment to <var>oldEnv</var>.</li><li>Return <emu-xref aoid="Completion"><a href="https://tc39.github.io/ecma262/#sec-completion-record-specification-type">Completion</a></emu-xref>(<var>status</var>).</li></ol></li><li>Let <var>B</var> be the result of evaluating <emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt>.</li><li>Set the <emu-xref href="#running-execution-context"><a href="https://tc39.github.io/ecma262/#running-execution-context">running execution context</a></emu-xref>'s LexicalEnvironment to <var>oldEnv</var>.</li><li>Return <emu-xref aoid="Completion"><a href="https://tc39.github.io/ecma262/#sec-completion-record-specification-type">Completion</a></emu-xref>(<var>B</var>).
      </li></ol></emu-alg>
      <emu-note><span class="note">Note 1</span>
        <p>No matter how control leaves the <emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt> the LexicalEnvironment is always restored to its former state.</p>
      </emu-note>
      <emu-note><span class="note">Note 2</span>
        <p><ins><emu-nt><a href="#prod-Else">Else</a></emu-nt> and <emu-nt><a href="#prod-Catch">Catch</a></emu-nt> have the same runtime semantics for CatchClauseEvaluation. However, the runtime semantics for <emu-nt>Try</emu-nt> invoke CatchClauseEvaluation differently in each case depending on the thrown exception.</ins></p>
      </emu-note>
    </emu-clause>

    <!-- es6num="13.15.8" -->
    <emu-clause id="sec-try-statement-runtime-semantics-evaluation">
      <h1><span class="secnum">4.1.8</span>Runtime Semantics: Evaluation<span class="utils"><span class="anchor"><a href="#sec-try-statement-runtime-semantics-evaluation">#</a></span></span></h1>
      <emu-grammar><emu-production name="TryStatement" collapsed="">
    <emu-nt><a href="#prod-TryStatement">TryStatement</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="a8714e57"><emu-t>try</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt><emu-nt><a href="#prod-Catch">Catch</a></emu-nt></emu-rhs>
</emu-production></emu-grammar>
      <emu-alg><ol><li>Let <var>B</var> be the result of evaluating <emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt>.</li><li>If <var>B</var>.[[Type]] is <emu-const>throw</emu-const>, let <var>C</var> be CatchClauseEvaluation of <emu-nt><a href="#prod-Catch">Catch</a></emu-nt> with parameter <var>B</var>.[[Value]].</li><li>Else, let <var>C</var> be <var>B</var>.</li><li>Return <emu-xref aoid="Completion"><a href="https://tc39.github.io/ecma262/#sec-completion-record-specification-type">Completion</a></emu-xref>(<emu-xref aoid="UpdateEmpty"><a href="https://tc39.github.io/ecma262/#sec-updateempty">UpdateEmpty</a></emu-xref>(<var>C</var>, <emu-val>undefined</emu-val>)).
      </li></ol></emu-alg>

      <ins><emu-grammar><emu-production name="TryStatement" collapsed="">
    <emu-nt><a href="#prod-TryStatement">TryStatement</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="f71a1290"><emu-t>try</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt><emu-nt><a href="#prod-Else">Else</a></emu-nt></emu-rhs>
</emu-production></emu-grammar>
      <emu-alg><ol><li><ins>Let <var>B</var> be the result of evaluating <emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt>.</ins></li><li><ins>If <var>B</var>.[[Type]] is <emu-const>throw</emu-const> and <var>B</var>.[[Value]] does not have a [[CancelBrand]] internal slot, let <var>C</var> be CatchClauseEvaluation of <emu-nt><a href="#prod-Else">Else</a></emu-nt> with parameter <var>B</var>.[[Value]].</ins></li><li><ins>Else, let <var>C</var> be <var>B</var>.</ins></li><li><ins>Return <emu-xref aoid="Completion"><a href="https://tc39.github.io/ecma262/#sec-completion-record-specification-type">Completion</a></emu-xref>(<emu-xref aoid="UpdateEmpty"><a href="https://tc39.github.io/ecma262/#sec-updateempty">UpdateEmpty</a></emu-xref>(<var>C</var>, <emu-val>undefined</emu-val>)).</ins>
      </li></ol></emu-alg>

      <emu-grammar><emu-production name="TryStatement" collapsed="">
    <emu-nt><a href="#prod-TryStatement">TryStatement</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="5ec68ab9"><emu-t>try</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt><emu-nt><a href="#prod-Finally">Finally</a></emu-nt></emu-rhs>
</emu-production></emu-grammar>
      <emu-alg><ol><li>Let <var>B</var> be the result of evaluating <emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt>.</li><li>Let <var>F</var> be the result of evaluating <emu-nt><a href="#prod-Finally">Finally</a></emu-nt>.</li><li>If <var>F</var>.[[Type]] is <emu-const>normal</emu-const>, let <var>F</var> be <var>B</var>.</li><li>Return <emu-xref aoid="Completion"><a href="https://tc39.github.io/ecma262/#sec-completion-record-specification-type">Completion</a></emu-xref>(<emu-xref aoid="UpdateEmpty"><a href="https://tc39.github.io/ecma262/#sec-updateempty">UpdateEmpty</a></emu-xref>(<var>F</var>, <emu-val>undefined</emu-val>)).
      </li></ol></emu-alg>

      <emu-grammar><emu-production name="TryStatement" collapsed="">
    <emu-nt><a href="#prod-TryStatement">TryStatement</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="1b19737c"><emu-t>try</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt><emu-nt><a href="#prod-Catch">Catch</a></emu-nt><emu-nt><a href="#prod-Finally">Finally</a></emu-nt></emu-rhs>
</emu-production></emu-grammar>
      <emu-alg><ol><li>Let <var>B</var> be the result of evaluating <emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt>.</li><li>If <var>B</var>.[[Type]] is <emu-const>throw</emu-const>, let <var>C</var> be CatchClauseEvaluation of <emu-nt><a href="#prod-Catch">Catch</a></emu-nt> with parameter <var>B</var>.[[Value]].</li><li>Else, let <var>C</var> be <var>B</var>.</li><li>Let <var>F</var> be the result of evaluating <emu-nt><a href="#prod-Finally">Finally</a></emu-nt>.</li><li>If <var>F</var>.[[Type]] is <emu-const>normal</emu-const>, let <var>F</var> be <var>C</var>.</li><li>Return <emu-xref aoid="Completion"><a href="https://tc39.github.io/ecma262/#sec-completion-record-specification-type">Completion</a></emu-xref>(<emu-xref aoid="UpdateEmpty"><a href="https://tc39.github.io/ecma262/#sec-updateempty">UpdateEmpty</a></emu-xref>(<var>F</var>, <emu-val>undefined</emu-val>)).
      </li></ol></emu-alg>

      <ins><emu-grammar><emu-production name="TryStatement" collapsed="">
    <emu-nt><a href="#prod-TryStatement">TryStatement</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="033c80ab"><emu-t>try</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt><emu-nt><a href="#prod-Else">Else</a></emu-nt><emu-nt><a href="#prod-Finally">Finally</a></emu-nt></emu-rhs>
</emu-production></emu-grammar></ins>
      <emu-alg><ol><li><ins>Let <var>B</var> be the result of evaluating <emu-nt><a href="https://tc39.github.io/ecma262/#prod-Block">Block</a></emu-nt>.</ins></li><li><ins>If <var>B</var>.[[Type]] is <emu-const>throw</emu-const> and <var>B</var>.[[Value]] does not have a [[CancelBrand]] internal slot, let <var>C</var> be CatchClauseEvaluation of <emu-nt><a href="#prod-Else">Else</a></emu-nt> with parameter <var>B</var>.[[Value]].</ins></li><li><ins>Else, let <var>C</var> be <var>B</var>.</ins></li><li><ins>Let <var>F</var> be the result of evaluating <emu-nt><a href="#prod-Finally">Finally</a></emu-nt>.</ins></li><li><ins>If <var>F</var>.[[Type]] is <emu-const>normal</emu-const>, let <var>F</var> be <var>C</var>.</ins></li><li><ins>Return <emu-xref aoid="Completion"><a href="https://tc39.github.io/ecma262/#sec-completion-record-specification-type">Completion</a></emu-xref>(<emu-xref aoid="UpdateEmpty"><a href="https://tc39.github.io/ecma262/#sec-updateempty">UpdateEmpty</a></emu-xref>(<var>F</var>, <emu-val>undefined</emu-val>)).</ins>
      </li></ol></emu-alg>
    </ins></emu-clause>
  </emu-clause>
</emu-clause>
</body>